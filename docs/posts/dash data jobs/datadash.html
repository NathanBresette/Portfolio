<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Nathan Bresette, Bek Usmonov, Riccardo Crapanzano">
<meta name="dcterms.date" content="2024-12-01">
<title>Data Salary Analysis Dashboard – Nathan Bresette</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c669134cb6dce3d72c3b40a8cf70a3cf.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Nathan Bresette</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../aboutme_index.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../consulting.html"> 
<span class="menu-text">Consulting</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../datafest.html"> 
<span class="menu-text">DataFest</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Resume.html"> 
<span class="menu-text">Resume</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#overview-of-project" id="toc-overview-of-project" class="nav-link active" data-scroll-target="#overview-of-project">Overview of Project</a></li>
  <li><a href="#group-code" id="toc-group-code" class="nav-link" data-scroll-target="#group-code">Group Code</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Data Salary Analysis Dashboard</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R-Shiny</div>
    <div class="quarto-category">Tidyverse</div>
    <div class="quarto-category">Plotly</div>
    <div class="quarto-category">Regression</div>
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Webscraping</div>
    <div class="quarto-category">R</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nathan Bresette, Bek Usmonov, Riccardo Crapanzano </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 1, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><p>RShiny dashboard that explores and visualizes data science salary trends from 2020-2024.</p>
<p><strong>Link to dashboard:</strong> https://nathanbresette.shinyapps.io/data324_project/</p>
<section id="overview-of-project" class="level1"><h1>Overview of Project</h1>
<p>The project utilized a Kaggle dataset containing anonymized salary data from the data field, with variables such as job title, experience level, company size, and geographic location. Our goal was to provide users with an interactive tool to better understand the factors influencing salaries across different roles and regions. Through various visualizations like boxplots, bar charts, and maps, the app allows users to filter the data by other criteria, making it easy to identify patterns and draw meaningful insights. This project was a valuable opportunity to apply our skills in R, data manipulation, and visualization while working collaboratively to ensure the dashboard was functional and user-friendly.</p>
<p>We highly recommend visiting the “Documentation” tab within the app for a more detailed explanation of the dataset, the features available, and how to navigate the dashboard. The app not only visualizes salary trends but also aims to answer key questions such as how location, experience, and employment type impact earnings. Users can explore whether they are being compensated fairly by leveraging the linear model integrated into the app. This collaborative effort highlights the power of data visualization in making informed career decisions, and we hope it serves as a useful resource for those entering or advancing within the data field</p>
</section><section id="group-code" class="level1"><h1>Group Code</h1>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT">DT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com">plotly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/rsconnect/">rsconnect</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span><span class="st">"data/world.gpkg"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># # Load country geometries from rnaturalearth</span></span>
<span><span class="co">#  world &lt;- ne_countries(scale = "medium", returnclass = "sf")</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#  world &lt;- world %&gt;%</span></span>
<span><span class="co">#    dplyr::select("iso_a2", "name", "continent")</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#  st_write(world, "~/Downloads/world.gpkg")</span></span>
<span> </span>
<span><span class="co"># Load Salaries dataset and clean it</span></span>
<span><span class="va">Salaries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/datafile.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Salaries_Clean</span> <span class="op">&lt;-</span> <span class="va">Salaries</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>remote_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">remote_ratio</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"On Site"</span>,</span>
<span>    <span class="va">remote_ratio</span> <span class="op">==</span> <span class="fl">100</span> <span class="op">~</span> <span class="st">"Remote"</span>,</span>
<span>    <span class="va">remote_ratio</span> <span class="op">==</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"Hybrid"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Other"</span></span>
<span>  <span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"On Site"</span>, <span class="st">"Hybrid"</span>, <span class="st">"Remote"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>experience_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">experience_level</span> <span class="op">==</span> <span class="st">"EN"</span> <span class="op">~</span> <span class="st">"Entry-Level"</span>,</span>
<span>    <span class="va">experience_level</span> <span class="op">==</span> <span class="st">"MI"</span> <span class="op">~</span> <span class="st">"Mid-Level"</span>,</span>
<span>    <span class="va">experience_level</span> <span class="op">==</span> <span class="st">"SE"</span> <span class="op">~</span> <span class="st">"Senior-Level"</span>,</span>
<span>    <span class="va">experience_level</span> <span class="op">==</span> <span class="st">"EX"</span> <span class="op">~</span> <span class="st">"Executive-Level"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Other"</span></span>
<span>  <span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Entry-Level"</span>, <span class="st">"Mid-Level"</span>, <span class="st">"Senior-Level"</span>, <span class="st">"Executive-Level"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>company_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">company_size</span> <span class="op">==</span> <span class="st">"S"</span> <span class="op">~</span> <span class="st">"Small"</span>,</span>
<span>    <span class="va">company_size</span> <span class="op">==</span> <span class="st">"M"</span> <span class="op">~</span> <span class="st">"Medium"</span>,</span>
<span>    <span class="va">company_size</span> <span class="op">==</span> <span class="st">"L"</span> <span class="op">~</span> <span class="st">"Large"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">company_size</span><span class="op">)</span></span>
<span>  <span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span> <span class="fu">::</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"employment_type"</span>, <span class="st">"salary_currency"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>    WorkLocation <span class="op">=</span> <span class="va">remote_ratio</span>,</span>
<span>    ExperienceLevel <span class="op">=</span> <span class="va">experience_level</span>,</span>
<span>    CompanySize <span class="op">=</span> <span class="va">company_size</span>,</span>
<span>    Salary <span class="op">=</span> <span class="va">salary</span>,</span>
<span>    WorkYear <span class="op">=</span> <span class="va">work_year</span>,</span>
<span>    JobTitle <span class="op">=</span> <span class="va">job_title</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Employee residence for mapping</span></span>
<span><span class="va">Salaries_Residence</span> <span class="op">&lt;-</span> <span class="va">Salaries</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">employee_residence</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            mean_salary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">salary_in_usd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            median_salary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">salary_in_usd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">Salaries_Clean_Regression</span> <span class="op">&lt;-</span> <span class="va">Salaries_Clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>salary_in_usd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">salary_in_usd</span><span class="op">)</span>,</span>
<span>         ExperienceLevel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ExperienceLevel</span><span class="op">)</span>,</span>
<span>         JobTitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">JobTitle</span><span class="op">)</span>,</span>
<span>         employee_residence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">employee_residence</span><span class="op">)</span>,</span>
<span>         company_location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">company_location</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">Salaries_Clean_Regression</span></span>
<span></span>
<span><span class="co"># Stepwise Regression model</span></span>
<span><span class="va">stepwise_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/stepAIC.html">stepAIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">salary_in_usd</span> <span class="op">~</span> <span class="va">ExperienceLevel</span> <span class="op">+</span> </span>
<span>                               <span class="va">JobTitle</span> <span class="op">+</span> <span class="va">employee_residence</span> <span class="op">+</span> <span class="va">WorkLocation</span> <span class="op">+</span> <span class="va">company_location</span> <span class="op">+</span> </span>
<span>                               <span class="va">CompanySize</span>, data <span class="op">=</span> <span class="va">dataset</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># World geometry join</span></span>
<span><span class="va">map_data</span> <span class="op">&lt;-</span> <span class="va">world</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">Salaries_Residence</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iso_a2"</span> <span class="op">=</span> <span class="st">"employee_residence"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/titlePanel.html">titlePanel</a></span><span class="op">(</span><span class="st">"Data Salary (USD) Analysis (2020-2024)"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabsetPanel.html">tabsetPanel</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html">tabPanel</a></span><span class="op">(</span><span class="st">"Data Frame"</span>,</span>
<span>             <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h4</a></span><span class="op">(</span><span class="st">"Data Salary Data Frame"</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html">DTOutput</a></span><span class="op">(</span><span class="st">"salaries_table"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html">tabPanel</a></span><span class="op">(</span><span class="st">"Location Map"</span>,</span>
<span>             <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h4</a></span><span class="op">(</span><span class="st">"Employee Residence by Country or Continent"</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarLayout</a></span><span class="op">(</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarPanel</a></span><span class="op">(</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"map_var"</span>, <span class="st">"Select Variable to Fill Map:"</span>,</span>
<span>                             choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Employee Count"</span> <span class="op">=</span> <span class="st">"count"</span>, </span>
<span>                                         <span class="st">"Mean Salary"</span> <span class="op">=</span> <span class="st">"mean_salary"</span>, </span>
<span>                                         <span class="st">"Median Salary"</span> <span class="op">=</span> <span class="st">"median_salary"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"group_var"</span>, <span class="st">"Group By:"</span>,</span>
<span>                             choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Country"</span>, <span class="st">"Continent"</span><span class="op">)</span><span class="op">)</span></span>
<span>               <span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">mainPanel</a></span><span class="op">(</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span><span class="st">"ggplot_map"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h4</a></span><span class="op">(</span><span class="st">"Grouped Table"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html">DTOutput</a></span><span class="op">(</span><span class="st">"continent_table"</span><span class="op">)</span></span>
<span>               <span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html">tabPanel</a></span><span class="op">(</span><span class="st">"Salary Box Plot"</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarLayout</a></span><span class="op">(</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarPanel</a></span><span class="op">(</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"color_var"</span>, <span class="st">"Choose X Input:"</span>, </span>
<span>                             choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ExperienceLevel"</span>, <span class="st">"WorkLocation"</span>, <span class="st">"CompanySize"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectizeInput</a></span><span class="op">(</span><span class="st">"filter_experience"</span>, <span class="st">"Experience Level:"</span>, </span>
<span>                                choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">ExperienceLevel</span><span class="op">)</span>, </span>
<span>                                multiple <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">ExperienceLevel</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectizeInput</a></span><span class="op">(</span><span class="st">"filter_location"</span>, <span class="st">"Work Location:"</span>, </span>
<span>                                choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">WorkLocation</span><span class="op">)</span>, </span>
<span>                                multiple <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">WorkLocation</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectizeInput</a></span><span class="op">(</span><span class="st">"filter_company"</span>, <span class="st">"Company Size:"</span>, </span>
<span>                                choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">CompanySize</span><span class="op">)</span>, </span>
<span>                                multiple <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">CompanySize</span><span class="op">)</span><span class="op">)</span></span>
<span>               <span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">mainPanel</a></span><span class="op">(</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plotly-shiny.html">plotlyOutput</a></span><span class="op">(</span><span class="st">"salary_box_plot"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h4</a></span><span class="op">(</span><span class="st">"Mean and Median Salary"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html">DTOutput</a></span><span class="op">(</span><span class="st">"summary_table"</span><span class="op">)</span></span>
<span>               <span class="op">)</span></span>
<span>             <span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html">tabPanel</a></span><span class="op">(</span><span class="st">"Work Location Proportions"</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarLayout</a></span><span class="op">(</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarPanel</a></span><span class="op">(</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"job_title"</span>, </span>
<span>                             <span class="st">"Select Job Title:"</span>, </span>
<span>                             choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">JobTitle</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                             selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">JobTitle</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                             multiple <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectizeInput</a></span><span class="op">(</span><span class="st">"filter_experience_proportions"</span>, </span>
<span>                                <span class="st">"Experience Level:"</span>, </span>
<span>                                choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">ExperienceLevel</span><span class="op">)</span>, </span>
<span>                                multiple <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">ExperienceLevel</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectizeInput</a></span><span class="op">(</span><span class="st">"filter_company_proportions"</span>, </span>
<span>                                <span class="st">"Company Size:"</span>, </span>
<span>                                choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">CompanySize</span><span class="op">)</span>, </span>
<span>                                multiple <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">$</span><span class="va">CompanySize</span><span class="op">)</span><span class="op">)</span></span>
<span>               <span class="op">)</span>,</span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">mainPanel</a></span><span class="op">(</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span><span class="st">"remote_ratio_plot"</span><span class="op">)</span></span>
<span>               <span class="op">)</span></span>
<span>             <span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html">tabPanel</a></span><span class="op">(</span><span class="st">"Salary Comparison by Residence"</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarLayout</a></span><span class="op">(</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarPanel</a></span><span class="op">(</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"company_size_input"</span>, <span class="st">"Company Size:"</span>,</span>
<span>                                        choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span> <span class="op">=</span> <span class="st">"S"</span>, <span class="st">"Medium"</span> <span class="op">=</span> <span class="st">"M"</span>, <span class="st">"Large"</span> <span class="op">=</span> <span class="st">"L"</span><span class="op">)</span>,</span>
<span>                                        multiple <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                        selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"S"</span>, <span class="st">"M"</span>, <span class="st">"L"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                            </span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"experience_level_input"</span>, <span class="st">"Experience Level:"</span>,</span>
<span>                                        choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Entry-Level"</span> <span class="op">=</span> <span class="st">"EN"</span>, <span class="st">"Mid-Level"</span> <span class="op">=</span> <span class="st">"MI"</span>, </span>
<span>                                                    <span class="st">"Senior-Level"</span> <span class="op">=</span> <span class="st">"SE"</span>, <span class="st">"Executive-Level"</span> <span class="op">=</span> <span class="st">"EX"</span><span class="op">)</span>,</span>
<span>                                        multiple <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                        selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"EN"</span>, <span class="st">"MI"</span>, <span class="st">"SE"</span>, <span class="st">"EX"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span></span>
<span>                   <span class="st">"work_location_input"</span>,</span>
<span>                   <span class="st">"Work Location:"</span>,</span>
<span>                   choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"On Site"</span> <span class="op">=</span> <span class="st">"100"</span>, <span class="st">"Hybrid"</span> <span class="op">=</span> <span class="st">"50"</span>, <span class="st">"Remote"</span> <span class="op">=</span> <span class="st">"0"</span><span class="op">)</span>, <span class="co"># Dynamically generate location choices</span></span>
<span>                   multiple <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   selected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"100"</span>, <span class="st">"50"</span>, <span class="st">"0"</span><span class="op">)</span><span class="op">)</span></span>
<span>               <span class="op">)</span>,</span>
<span>               </span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">mainPanel</a></span><span class="op">(</span></span>
<span>                 <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plotly-shiny.html">plotlyOutput</a></span><span class="op">(</span><span class="st">"residence_plot"</span><span class="op">)</span></span>
<span>               <span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    </span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html">tabPanel</a></span><span class="op">(</span><span class="st">"Salary Prediction"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarLayout</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">sidebarPanel</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"experience_level"</span>, <span class="st">"Experience Level:"</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">ExperienceLevel</span><span class="op">)</span>, selected <span class="op">=</span> <span class="st">"EX"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"worklocation"</span>, <span class="st">"Work Location:"</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">WorkLocation</span><span class="op">)</span>, selected <span class="op">=</span> <span class="st">"Hybrid"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"employee_residence"</span>, <span class="st">"Employee Country Residence:"</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">employee_residence</span><span class="op">)</span>, selected <span class="op">=</span> <span class="st">"US"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"companysize"</span>, <span class="st">"Company Size:"</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">CompanySize</span><span class="op">)</span>, selected <span class="op">=</span> <span class="st">"Medium"</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span><span class="st">"jobtitle"</span>, <span class="st">"Job Title:"</span>, choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">JobTitle</span><span class="op">)</span>, selected <span class="op">=</span> <span class="st">"Admin &amp; Data Analyst"</span><span class="op">)</span>,</span>
<span>        </span>
<span>        <span class="co"># Trigger prediction</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton</a></span><span class="op">(</span><span class="st">"predict"</span>, <span class="st">"Predict Salary"</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      </span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html">mainPanel</a></span><span class="op">(</span></span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">style</span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/HTML.html">HTML</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">    h3 {</span></span>
<span><span class="st">      font-size: 30px;</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">    #predicted_salary {</span></span>
<span><span class="st">      font-size: 24px;</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  "</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h3</a></span><span class="op">(</span><span class="st">"Press the button to predict the salary"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html">textOutput</a></span><span class="op">(</span><span class="st">"predicted_salary"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    </span>
<span>    </span>
<span>    </span>
<span>    <span class="co"># Documentation Tab UI (if you're using `tabPanel` in Shiny)</span></span>
<span>    <span class="co"># Documentation Tab UI (using tags$ul and tags$li for lists)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html">tabPanel</a></span><span class="op">(</span></span>
<span>      <span class="st">"Documentation"</span>,</span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h3</a></span><span class="op">(</span><span class="st">"Introduction to the Data Set"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"This dataset is from Kaggle and provides anonymized information about salaries in the data field for 2024. It has a variety of factors that influence salaries, including experience level, job title, employment type (Remote/Onsite/Hybrid), and company size (Small/Medium/Large). The data also includes geographic location information."</span><span class="op">)</span>,</span>
<span>      </span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"Key variables included in this dataset are:"</span><span class="op">)</span>,</span>
<span>      <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span></span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">strong</a></span><span class="op">(</span><span class="st">"Experience Level:"</span><span class="op">)</span> , <span class="st">" The employees experience level in the data field, categorized as 'Entry-level', 'Mid-level', and 'Senior-level', and 'Executive-level'."</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">strong</a></span><span class="op">(</span><span class="st">"Job Title:"</span><span class="op">)</span> , <span class="st">" The specific job title held by the individual, such as Data Scientist, Data Analyst, or Machine Learning Engineer."</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">strong</a></span><span class="op">(</span><span class="st">"Company Size:"</span><span class="op">)</span> , <span class="st">" The size of the company where the individual is employed, classified into 'Small', 'Medium', and 'Large' companies"</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">strong</a></span><span class="op">(</span><span class="st">"Employment Type:"</span><span class="op">)</span> , <span class="st">" Whether the individual is working remotely, onsite, or hybrid."</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">strong</a></span><span class="op">(</span><span class="st">"Location:"</span><span class="op">)</span> , <span class="st">" The geographical location of the individual,  representing a country or continent."</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">strong</a></span><span class="op">(</span><span class="st">"Salary:"</span><span class="op">)</span> , <span class="st">" The compensation (in USD) received by the individual, representing their annual income."</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      </span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h3</a></span><span class="op">(</span><span class="st">"Motivation for Creating the App"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"The primary motivation behind this app is to allow users to explore and analyze the factors that influence data salaries. With the increasing interest in data as a career, there is a growing need to understand what variables affect salary ranges in this field. By visualizing the salary data across various factors such as experience level, job title, company size, and geographic location, users can gain insights into the salary landscape for data professionals."</span><span class="op">)</span>,</span>
<span>      </span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"Specific questions that motivated the creation of the app include:"</span><span class="op">)</span>,</span>
<span>      <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span></span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"How do salaries vary by geographic location, and what factors are most influential in determining location-based pay differences?"</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"How does salary differ by experience level, job title, and company size?"</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"What impact does working remotely or in person have on data salaries?"</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Based on a linear model, are you being payed fairly?"</span><span class="op">)</span>,</span>
<span>        </span>
<span>      <span class="op">)</span>,</span>
<span>      </span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"By providing these insights, the app aims to empower users with the ability to see their own salaries, evaluate job market trends, and make data-driven career decisions in the field of data."</span><span class="op">)</span>,</span>
<span>      </span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h3</a></span><span class="op">(</span><span class="st">"How the App Works"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"This app allows users to interactively explore the relationships between salary and various factors. The key features of the app are:"</span><span class="op">)</span>,</span>
<span>      <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span></span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Dynamic Filtering: Users can filter the data by experience level, job title, company size, and work location. This helps to focus on specific subsets of the data."</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Visualizing Salary Trends: The app generates various visualizations, such as maps, boxplots, and bar charts, to show how salaries are influenced by different variables. Users can easily see how compensation changes with different levels of experience, company size, and job titles."</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Geographic Insights: Location-based salary data is displayed, allowing users to compare compensation trends across different geographic areas. Due to limited data, there is a small count for several countries/continents"</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Interactive Graphs: Users can hover over visualizations in real time, helping them answer specific questions or dive deeper into the data for more information."</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"Users can start by selecting one or more variables and adjusting filters to view trends in the dataset. They can then explore the correlations between salaries and factors such as experience level, location, and job title through the visual representations provided."</span><span class="op">)</span>,</span>
<span>      </span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h3</a></span><span class="op">(</span><span class="st">"Conclusions"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"From analyzing the dataset, several trends emerge:"</span><span class="op">)</span>,</span>
<span>      <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span></span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Geographical Location: Although the United States and North America have some of the best mean/median pay, conclusions can not be drawn since the counts for other countries and continents are so low."</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Experience Level: Higher experience levels generally correlate with higher salaries. Senior and executive roles have a significant salary increase compared to entry-level positions."</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Company Size: Larger and medium companies tend to offer higher salaries, likely due to greater financial resources and the scale of operations. Due to a low count for small countries, it may not be entirely accurate"</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Work Location: On site jobs have a higher pay than remote and hybrid job. Hybrid jobs have a signifcantly lower count so more data would need to be collected for more accurate conclusions."</span><span class="op">)</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span><span class="st">"Salary Comparison by Residence: Those who work in the country they reside in have a higher salary than those who do not overall. Due to the low count of those who do not reside in the country they work in, more data would need to be collected for more accuratae conclusions"</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"This app helps users see these patterns and more. By interacting with the visualizations, users can draw their own conclusions about the data job market, and make informed decisions about their career paths or salary expectations."</span><span class="op">)</span>,</span>
<span>      </span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">h3</a></span><span class="op">(</span><span class="st">"Citations"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">p</a></span><span class="op">(</span><span class="st">"Data Source: The dataset used in this app is sourced from "</span>, <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html">a</a></span><span class="op">(</span>href <span class="op">=</span> <span class="st">"https://www.kaggle.com/datasets/yusufdelikkaya/datascience-salaries-2024/data"</span>, <span class="st">"Kaggle: Data Science Salaries 2024"</span><span class="op">)</span>, <span class="st">"."</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="va">filtered_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">Salaries_Clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>        <span class="va">ExperienceLevel</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">input</span><span class="op">$</span><span class="va">filter_experience</span>,</span>
<span>        <span class="va">WorkLocation</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">input</span><span class="op">$</span><span class="va">filter_location</span>,</span>
<span>        <span class="va">CompanySize</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">input</span><span class="op">$</span><span class="va">filter_company</span></span>
<span>        </span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">filtered_data_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">Salaries_Clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>        <span class="va">ExperienceLevel</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">input</span><span class="op">$</span><span class="va">filter_experience_proportions</span>,</span>
<span>        <span class="va">CompanySize</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">input</span><span class="op">$</span><span class="va">filter_company_proportions</span>,</span>
<span>        <span class="va">JobTitle</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">input</span><span class="op">$</span><span class="va">job_title</span></span>
<span>      <span class="op">)</span> </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Data Table</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">salaries_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html">renderDT</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">Salaries_Clean</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Salary Box Plot</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">salary_box_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plotly-shiny.html">renderPlotly</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">filtered_data</span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">color_var</span>, y <span class="op">=</span> <span class="st">"salary_in_usd"</span>, fill <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">color_var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span>  </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Salary Box Plot by"</span>, <span class="va">input</span><span class="op">$</span><span class="va">color_var</span><span class="op">)</span>,</span>
<span>           x <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">color_var</span>,</span>
<span>           y <span class="op">=</span> <span class="st">"Salary (USD)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Begin later for lighter purple</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>  </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Mean and Median Table</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">summary_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html">renderDT</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">Salaries_Clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">color_var</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>        `Count` <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        `Mean Salary`<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">salary_in_usd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>        `Median Salary` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">salary_in_usd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="op">)</span> </span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">remote_ratio_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">filtered_data_2</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">WorkYear</span>, <span class="va">WorkLocation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">'drop'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>percentage <span class="op">=</span> <span class="va">count</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">WorkYear</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">percentage</span>, fill <span class="op">=</span> <span class="va">WorkLocation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Proportion of Work Locations for Selected Filters by Year"</span><span class="op">)</span>,</span>
<span>           x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>           y <span class="op">=</span> <span class="st">"Proportion (%)"</span>,</span>
<span>           fill <span class="op">=</span> <span class="st">"Work Location"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_fill_viridis</a></span><span class="op">(</span>discrete <span class="op">=</span> <span class="cn">TRUE</span>, begin <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Begin later so lighter purple</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span>  </span>
<span>  </span>
<span></span>
<span>  </span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">ggplot_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="co"># Dynamically group data with ifelse</span></span>
<span>    <span class="va">grouped_map_data</span> <span class="op">&lt;-</span> <span class="va">map_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu">st_set_geometry</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># Drop geometry for aggregation</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">group_var</span> <span class="op">==</span> <span class="st">"Country"</span><span class="op">)</span> <span class="va">name</span> <span class="kw">else</span> <span class="va">continent</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>        count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        mean_salary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_salary</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>        median_salary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">median_salary</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">world</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Group"</span> <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">group_var</span> <span class="op">==</span> <span class="st">"Country"</span><span class="op">)</span> <span class="st">"name"</span> <span class="kw">else</span> <span class="st">"continent"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu">st_as_sf</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Reattach geometry after grouping</span></span>
<span>    </span>
<span>    <span class="co"># Extract the range of the selected variable</span></span>
<span>    <span class="va">selected_var</span> <span class="op">&lt;-</span> <span class="va">grouped_map_data</span><span class="op">[[</span><span class="va">input</span><span class="op">$</span><span class="va">map_var</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">min_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">selected_var</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">max_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">selected_var</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Plot the map</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">grouped_map_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html">aes_string</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">map_var</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_fill_viridis</a></span><span class="op">(</span></span>
<span>        option <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>        direction <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        na.value <span class="op">=</span> <span class="st">"lightgrey"</span>,</span>
<span>        limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">min_val</span>, <span class="va">max_val</span><span class="op">)</span>,  <span class="co"># Ensure the scale fits the range</span></span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">min_val</span>, <span class="va">max_val</span><span class="op">)</span>,  <span class="co"># Only show min and max in the legend</span></span>
<span>        labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>          <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">group_var</span> <span class="op">==</span> <span class="st">"Country"</span><span class="op">)</span> <span class="st">"Employee Residence by Country"</span> <span class="kw">else</span> <span class="st">"Employee Residence by Continent"</span>,</span>
<span>          <span class="st">"-"</span>, <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">map_var</span> <span class="op">==</span> <span class="st">"count"</span><span class="op">)</span> <span class="st">"Employee Count"</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">map_var</span> <span class="op">==</span> <span class="st">"mean_salary"</span><span class="op">)</span> <span class="st">"Mean Salary"</span> <span class="kw">else</span> <span class="st">"Median Salary"</span></span>
<span>        <span class="op">)</span>,</span>
<span>        fill <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">map_var</span> <span class="op">==</span> <span class="st">"count"</span><span class="op">)</span> <span class="st">"Employee Count"</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">map_var</span> <span class="op">==</span> <span class="st">"mean_salary"</span><span class="op">)</span> <span class="st">"Mean Salary"</span> <span class="kw">else</span> <span class="st">"Median Salary"</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span></span>
<span>  </span>
<span>  </span>
<span>  <span class="co"># Grouped Table</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">continent_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html">renderDT</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">grouped_data</span> <span class="op">&lt;-</span> <span class="va">map_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu">st_set_geometry</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># Drop geometry column</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span>group <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">group_var</span> <span class="op">==</span> <span class="st">"Country"</span><span class="op">)</span> <span class="va">name</span> <span class="kw">else</span> <span class="va">continent</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>        `Employee Count` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>        `Mean Salary` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_salary</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>        `Median Salary` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">median_salary</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">`Employee Count`</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">grouped_data</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pageLength <span class="op">=</span> <span class="fl">5</span>, searching <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">residence_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plotly-shiny.html">renderPlotly</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># Filter based on inputs</span></span>
<span>    <span class="va">filtered_data3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="va">Salaries</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>          <span class="va">company_size</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">input</span><span class="op">$</span><span class="va">company_size_input</span>,</span>
<span>          <span class="va">experience_level</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">input</span><span class="op">$</span><span class="va">experience_level_input</span>,</span>
<span>          <span class="va">remote_ratio</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">input</span><span class="op">$</span><span class="va">work_location_input</span> </span>
<span>          </span>
<span>        <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>          CompanySize <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">company_size</span> <span class="op">==</span> <span class="st">"S"</span> <span class="op">~</span> <span class="st">"Small"</span>,</span>
<span>            <span class="va">company_size</span> <span class="op">==</span> <span class="st">"M"</span> <span class="op">~</span> <span class="st">"Medium"</span>,</span>
<span>            <span class="va">company_size</span> <span class="op">==</span> <span class="st">"L"</span> <span class="op">~</span> <span class="st">"Large"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">company_size</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>          ExperienceLevel <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>            <span class="va">experience_level</span> <span class="op">==</span> <span class="st">"EN"</span> <span class="op">~</span> <span class="st">"Entry-Level"</span>,</span>
<span>            <span class="va">experience_level</span> <span class="op">==</span> <span class="st">"MI"</span> <span class="op">~</span> <span class="st">"Mid-Level"</span>,</span>
<span>            <span class="va">experience_level</span> <span class="op">==</span> <span class="st">"SE"</span> <span class="op">~</span> <span class="st">"Senior-Level"</span>,</span>
<span>            <span class="va">experience_level</span> <span class="op">==</span> <span class="st">"EX"</span> <span class="op">~</span> <span class="st">"Executive-Level"</span>,</span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">experience_level</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>          ResidesInWorkCountry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>            <span class="va">employee_residence</span> <span class="op">==</span> <span class="va">company_location</span>,</span>
<span>            <span class="st">"Resides in Work Country"</span>,</span>
<span>            <span class="st">"Does Not Reside in Work Country"</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">filtered_data3</span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Count observations </span></span>
<span>    <span class="va">counts</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ResidesInWorkCountry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Make plot</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/plot_ly.html">plot_ly</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">data</span>,</span>
<span>      x <span class="op">=</span> <span class="op">~</span><span class="va">ResidesInWorkCountry</span>,</span>
<span>      y <span class="op">=</span> <span class="op">~</span><span class="va">salary_in_usd</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"box"</span>,</span>
<span>      color <span class="op">=</span> <span class="op">~</span><span class="va">ResidesInWorkCountry</span>,</span>
<span>      colors <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>      boxmean <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu">layout</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Salary Distribution for Residents vs Non-Residents in Work Country"</span>,</span>
<span>        xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Residency Status"</span><span class="op">)</span>,</span>
<span>        yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Salary (USD)"</span><span class="op">)</span>,</span>
<span>        showlegend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>        </span>
<span>      <span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="co"># Add count above the boxplots</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/plotly/man/add_annotations.html">add_annotations</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">counts</span><span class="op">$</span><span class="va">ResidesInWorkCountry</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">salary_in_usd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fl">5000</span>, <span class="co"># Adjust position</span></span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Count: "</span>, <span class="va">counts</span><span class="op">$</span><span class="va">count</span><span class="op">)</span>,</span>
<span>        showarrow <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        font <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        xanchor <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>        yanchor <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>      <span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Return the plot</span></span>
<span>    <span class="va">p</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">predict</span>, <span class="op">{</span></span>
<span>    <span class="co"># Collect inputs </span></span>
<span>    <span class="va">new_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>      ExperienceLevel <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">experience_level</span>,</span>
<span>      WorkLocation <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">worklocation</span>,</span>
<span>      employee_residence <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">employee_residence</span>,</span>
<span>      CompanySize <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">companysize</span>,</span>
<span>      JobTitle <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">jobtitle</span>,  </span>
<span>      stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># IDK why this worked</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Predict salary using stepwise model</span></span>
<span>    <span class="va">predicted_salary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">stepwise_model</span>, newdata <span class="op">=</span> <span class="va">new_data</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Output salary</span></span>
<span>    <span class="va">output</span><span class="op">$</span><span class="va">predicted_salary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The predicted salary in USD is $"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">predicted_salary</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span>ui <span class="op">=</span> <span class="va">ui</span>, server <span class="op">=</span> <span class="va">server</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
      <i class="bi bi-phone" role="img">
</i> 
 816-969-0150
  </li>  
</ul>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://linkedin.com">
<p>LinkedIn</p>
</a>
  </li>  
</ul>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
      <i class="bi bi-envelope" role="img">
</i> 
 nathanbresette04@gmail.com
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>